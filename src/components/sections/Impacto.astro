---
import Container from '../core/Container.astro';
---

<section class="py-12 md:py-16">
  <div class="w-full px-4 sm:px-6 md:px-8 lg:px-10 max-w-[1800px] mx-auto">
    <div class="space-y-4 w-full">
      <!-- Título -->
      <h2 
        class="font-['Inter'] text-[24px] sm:text-[28px] md:text-[32px] lg:text-[36px] leading-[100%] tracking-[0%] text-[#00142C] font-medium text-left"
        data-aos="fade-up"
      >
        Impacto de la <span class="font-bold">fragmentación</span> en la cadena de valor
      </h2>

      <!-- Línea divisoria -->
      <div 
        class="w-full h-[1px] bg-gradient-to-r from-[#4F3800] via-[#FFB603] to-[#FFB603]"
        data-aos="fade-up"
        data-aos-delay="100"
      ></div>

      <!-- Slider de imágenes -->
      <div class="relative w-full max-w-[1200px] mx-auto mt-8 md:mt-12 group" data-aos="fade-up" data-aos-delay="200">
        <div class="overflow-hidden rounded-xl">
          <div id="slider-track" class="flex transition-transform duration-500 ease-out">
            <!-- Slide 1 -->
            <div class="w-full flex-shrink-0">
              <img src="/src/assets/images/productos/hardware/Frame.svg" alt="Impacto 1" class="w-full h-auto object-cover" />
            </div>
            <!-- Slide 2 -->
            <div class="w-full flex-shrink-0">
              <img src="/src/assets/images/productos/hardware/Frame2.svg" alt="Impacto 2" class="w-full h-auto object-cover" />
            </div>
            <!-- Slide 3 -->
            <div class="w-full flex-shrink-0">
              <img src="/src/assets/images/productos/hardware/Frame3.svg" alt="Impacto 3" class="w-full h-auto object-cover" />
            </div>
          </div>
        </div>

        <!-- Botón Anterior -->
        <button 
          id="prev-btn"
          class="absolute top-1/2 left-4 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white p-3 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 focus:outline-none backdrop-blur-sm"
          aria-label="Anterior imagen"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>

        <!-- Botón Siguiente -->
        <button 
          id="next-btn"
          class="absolute top-1/2 right-4 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white p-3 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-300 focus:outline-none backdrop-blur-sm"
          aria-label="Siguiente imagen"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>

        <!-- Indicadores (Puntos) -->
        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2">
          <button class="w-2.5 h-2.5 rounded-full bg-white/50 hover:bg-white transition-colors indicator active" data-index="0"></button>
          <button class="w-2.5 h-2.5 rounded-full bg-white/50 hover:bg-white transition-colors indicator" data-index="1"></button>
          <button class="w-2.5 h-2.5 rounded-full bg-white/50 hover:bg-white transition-colors indicator" data-index="2"></button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const track = document.getElementById('slider-track');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  const indicators = document.querySelectorAll('.indicator');
  let currentIndex = 0;
  const totalSlides = 3;
  let autoSlideInterval: ReturnType<typeof setInterval>;

  const updateSlider = () => {
    if (track) {
      track.style.transform = `translateX(-${currentIndex * 100}%)`;
    }
    
    // Actualizar indicadores
    indicators.forEach((ind, idx) => {
      if (idx === currentIndex) {
        ind.classList.add('bg-white', 'scale-110');
        ind.classList.remove('bg-white/50');
      } else {
        ind.classList.remove('bg-white', 'scale-110');
        ind.classList.add('bg-white/50');
      }
    });
  };

  const nextSlide = () => {
    currentIndex = (currentIndex + 1) % totalSlides;
    updateSlider();
  };

  const prevSlide = () => {
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateSlider();
  };

  // Event Listeners
  nextBtn?.addEventListener('click', () => {
    nextSlide();
    resetAutoSlide();
  });

  prevBtn?.addEventListener('click', () => {
    prevSlide();
    resetAutoSlide();
  });

  indicators.forEach((ind) => {
    ind.addEventListener('click', (e) => {
      const target = e.target as HTMLElement;
      currentIndex = parseInt(target.dataset.index || '0');
      updateSlider();
      resetAutoSlide();
    });
  });

  // Auto-play
  const startAutoSlide = () => {
    autoSlideInterval = setInterval(nextSlide, 5000); // Cambia cada 5 segundos
  };

  const resetAutoSlide = () => {
    clearInterval(autoSlideInterval);
    startAutoSlide();
  };

  // Iniciar slider y auto-play
  updateSlider();
  startAutoSlide();
</script>
